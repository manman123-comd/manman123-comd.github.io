<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>é—²åœ¨æ ¡å›­å¹³å°</title>
  <style>
    :root {
      --primary: #4361ee;
      --primary-dark: #3a0ca3;
      --accent: #e76f51;
      --light-gray: #f5f5f5;
      --mid-gray: #ddd;
      --dark-gray: #666;
      --text-color: #333;
      --white: #fff;
      --shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      --shadow-hover: 0 5px 15px rgba(0, 0, 0, 0.15);
      --transition: all 0.3s ease;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
      background-color: var(--light-gray);
      color: var(--text-color);
      line-height: 1.6;
    }

    header {
      background: linear-gradient(90deg, var(--primary), var(--primary-dark));
      color: var(--white);
      padding: 1.5rem 0;
      text-align: center;
      box-shadow: var(--shadow);
      position: relative;
    }

    header h1 {
      font-size: 1.8rem;
      margin-bottom: 0.5rem;
    }

    header p {
      opacity: 0.9;
      font-size: 0.95rem;
    }

    .container {
      max-width: 1200px;
      margin: 1.5rem auto;
      padding: 0 1rem;
      display: grid;
      grid-template-columns: 350px 1fr;
      gap: 1.5rem;
    }

    .form-section,
    .list-section {
      background: var(--white);
      padding: 1.5rem;
      border-radius: 8px;
      box-shadow: var(--shadow);
      transition: var(--transition);
    }

    .form-section:hover,
    .list-section:hover {
      box-shadow: var(--shadow-hover);
    }

    .form-section h2,
    .list-section h2 {
      margin-top: 0;
      color: var(--primary-dark);
      padding-bottom: 0.75rem;
      border-bottom: 2px solid var(--light-gray);
      margin-bottom: 1.25rem;
    }

    .form-group {
      margin-bottom: 1.25rem;
    }

    label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: 600;
      color: var(--text-color);
    }

    input,
    textarea,
    select {
      width: 100%;
      padding: 0.75rem;
      border: 1px solid var(--mid-gray);
      border-radius: 4px;
      font-size: 1rem;
      transition: var(--transition);
    }

    input:focus,
    textarea:focus,
    select:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.1);
    }

    textarea {
      resize: vertical;
      min-height: 100px;
    }

    button {
      padding: 0.75rem 1.25rem;
      background: var(--primary);
      color: var(--white);
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 1rem;
      font-weight: 600;
      transition: var(--transition);
    }

    button:hover {
      background: var(--primary-dark);
      transform: translateY(-2px);
    }

    button.delete-btn {
      background: #e63946;
      margin-top: 0.75rem;
      padding: 0.5rem;
      font-size: 0.9rem;
    }

    button.delete-btn:hover {
      background: #d62828;
    }

    .filter-container {
      margin-bottom: 1.5rem;
      display: flex;
      align-items: center;
      gap: 1rem;
      flex-wrap: wrap;
    }

    .filter-container select {
      width: auto;
      min-width: 180px;
    }

    .product-list {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
      gap: 1.5rem;
    }

    .product-card {
      border: 1px solid #eee;
      border-radius: 8px;
      overflow: hidden;
      transition: var(--transition);
      position: relative;
    }

    .product-card:hover {
      transform: translateY(-5px);
      box-shadow: var(--shadow-hover);
    }

    .product-img {
      width: 100%;
      height: 180px;
      object-fit: cover;
      display: block;
      transition: var(--transition);
    }

    .product-card:hover .product-img {
      transform: scale(1.05);
    }

    .product-img-container {
      overflow: hidden;
      height: 180px;
    }

    .product-info {
      padding: 1rem;
    }

    .product-title {
      font-size: 1.1rem;
      margin: 0 0 0.5rem;
      color: var(--text-color);
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    .product-price {
      color: var(--accent);
      font-weight: bold;
      margin-bottom: 0.5rem;
      font-size: 1.1rem;
    }

    .product-category {
      display: inline-block;
      font-size: 0.8rem;
      color: var(--primary);
      background: rgba(67, 97, 238, 0.1);
      padding: 0.2rem 0.5rem;
      border-radius: 4px;
      margin-bottom: 0.5rem;
    }

    /* è”ç³»æ–¹å¼æ ·å¼ */
    .product-contact {
      color: var(--primary);
      font-size: 0.9rem;
      margin: 0.5rem 0;
      display: flex;
      align-items: center;
      gap: 0.3rem;
      font-weight: 500;
    }

    .product-desc {
      color: var(--dark-gray);
      font-size: 0.9rem;
      line-height: 1.5;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      /* å‡å°‘æè¿°è¡Œæ•°ï¼Œç•™å‡ºè”ç³»æ–¹å¼ç©ºé—´ */
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    /* è¡¨å•æç¤ºæ–‡å­— */
    .form-tip {
      font-size: 0.8rem;
      color: var(--dark-gray);
      margin-top: 0.3rem;
    }

    .empty-state {
      grid-column: 1/-1;
      text-align: center;
      padding: 3rem 1rem;
      color: var(--dark-gray);
    }

    .empty-state i {
      font-size: 3rem;
      margin-bottom: 1rem;
      color: var(--mid-gray);
    }

    .notification {
      position: fixed;
      top: 1rem;
      right: 1rem;
      padding: 1rem 1.5rem;
      background: var(--white);
      border-left: 4px solid var(--primary);
      box-shadow: var(--shadow-hover);
      border-radius: 4px;
      transform: translateX(120%);
      transition: transform 0.3s ease;
      z-index: 1000;
    }

    .notification.show {
      transform: translateX(0);
    }

    .notification.error {
      border-left-color: #e63946;
    }

    .loading {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid rgba(255, 255, 255, .3);
      border-radius: 50%;
      border-top-color: white;
      animation: spin 1s ease-in-out infinite;
      margin-right: 0.5rem;
    }

    @keyframes spin {
      to {
        transform: rotate(360deg);
      }
    }

    @media (max-width: 768px) {
      .container {
        grid-template-columns: 1fr;
      }

      .product-list {
        grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
      }

      .filter-container {
        flex-direction: column;
        align-items: stretch;
      }

      .filter-container select {
        width: 100%;
      }
    }
  </style>
</head>

<body>
  <header>
    <h1>é—²åœ¨æ ¡å›­å¹³å°</h1>
    <p>ä¾¿æ·ã€å®‰å…¨çš„æ ¡å›­é—²ç½®ç‰©å“äº¤æ˜“å¸‚åœº</p>
  </header>

  <div class="container">
    <!-- å‘å¸ƒå•†å“è¡¨å• -->
    <section class="form-section">
      <h2>å‘å¸ƒäºŒæ‰‹å•†å“</h2>
      <form id="productForm">
        <div class="form-group">
          <label for="category">å•†å“åˆ†ç±»</label>
          <select id="category" required>
            <option value="">è¯·é€‰æ‹©åˆ†ç±»</option>
            <option value="ç”µå­æ•°ç ">ç”µå­æ•°ç </option>
            <option value="ç”Ÿæ´»ç”¨å“">ç”Ÿæ´»ç”¨å“</option>
            <option value="å­¦ä¹ èµ„æ–™">å­¦ä¹ èµ„æ–™</option>
            <option value="ä½“è‚²å™¨æ">ä½“è‚²å™¨æ</option>
            <option value="æœè£…é‹å¸½">æœè£…é‹å¸½</option>
            <option value="å…¶ä»–">å…¶ä»–</option>
          </select>
        </div>
        <div class="form-group">
          <label for="title">å•†å“æ ‡é¢˜</label>
          <input type="text" id="title" required placeholder="ä¾‹å¦‚ï¼šä¹æˆæ–° iPhone 13" />
        </div>
        <div class="form-group">
          <label for="price">ä»·æ ¼ï¼ˆå…ƒï¼‰</label>
          <input type="number" id="price" required step="0.01" min="0" />
        </div>
        <!-- æ–°å¢è”ç³»æ–¹å¼å­—æ®µ -->
        <div class="form-group">
          <label for="contact">è”ç³»æ–¹å¼</label>
          <input type="text" id="contact" required placeholder="å¾®ä¿¡/ç”µè¯ï¼Œæ–¹ä¾¿ä¹°å®¶è”ç³»" />
          <div class="form-tip">å»ºè®®å¡«å†™å¾®ä¿¡ï¼Œæ ¡å›­å†…æ²Ÿé€šæ›´ä¾¿æ·</div>
        </div>
        <div class="form-group">
          <label for="description">å•†å“æè¿°</label>
          <textarea id="description" rows="4" placeholder="æè¿°å•†å“çš„è¯¦ç»†ä¿¡æ¯å’Œæˆè‰²"></textarea>
        </div>
        <div class="form-group">
          <label for="imageUrl">å›¾ç‰‡é“¾æ¥</label>
          <input type="url" id="imageUrl" placeholder="è¾“å…¥å›¾ç‰‡çš„ç½‘ç»œé“¾æ¥" />
        </div>
        <button type="submit" id="submitBtn">
          <span id="buttonText">å‘å¸ƒå•†å“</span>
          <span class="loading" style="display: none;"></span>
        </button>
      </form>
    </section>

    <!-- å•†å“åˆ—è¡¨ -->
    <section class="list-section">
      <h2>æœ€æ–°å•†å“</h2>
      <div class="filter-container">
        <select id="categoryFilter">
          <option value="all">å…¨éƒ¨åˆ†ç±»</option>
          <option value="ç”µå­æ•°ç ">ç”µå­æ•°ç </option>
          <option value="ç”Ÿæ´»ç”¨å“">ç”Ÿæ´»ç”¨å“</option>
          <option value="å­¦ä¹ èµ„æ–™">å­¦ä¹ èµ„æ–™</option>
          <option value="ä½“è‚²å™¨æ">ä½“è‚²å™¨æ</option>
          <option value="æœè£…é‹å¸½">æœè£…é‹å¸½</option>
          <option value="å…¶ä»–">å…¶ä»–</option>
        </select>
        <button id="clearFilter">æ¸…é™¤ç­›é€‰</button>
      </div>
      <div id="productList" class="product-list"></div>
    </section>
  </div>

  <div id="notification" class="notification"></div>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      // DOMå…ƒç´ 
      const form = document.getElementById("productForm");
      const listContainer = document.getElementById("productList");
      const categoryFilter = document.getElementById("categoryFilter");
      const clearFilterBtn = document.getElementById("clearFilter");
      const notification = document.getElementById("notification");
      const submitBtn = document.getElementById("submitBtn");
      const buttonText = document.getElementById("buttonText");
      const loadingIndicator = submitBtn.querySelector(".loading");

      // åˆå§‹åŒ–ï¼šä»localStorageåŠ è½½å•†å“
      let products = JSON.parse(localStorage.getItem("secondHandProducts") || "[]");
      let currentFilter = "all";

      renderProducts();

      // è¡¨å•æäº¤å¤„ç†
      form.addEventListener("submit", async (e) => {
        e.preventDefault();

        // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
        buttonText.textContent = "å‘å¸ƒä¸­";
        loadingIndicator.style.display = "inline-block";
        submitBtn.disabled = true;

        try {
          // æ¨¡æ‹Ÿç½‘ç»œå»¶è¿Ÿ
          await new Promise(resolve => setTimeout(resolve, 800));

          const category = document.getElementById("category").value;
          const title = document.getElementById("title").value.trim();
          const price = parseFloat(document.getElementById("price").value);
          const contact = document.getElementById("contact").value.trim(); // è·å–è”ç³»æ–¹å¼
          const description = document.getElementById("description").value.trim();
          const imageUrl = document.getElementById("imageUrl").value.trim() || "https://via.placeholder.com/250x180?text=No+Image";

          // è¡¨å•éªŒè¯
          if (!title) {
            showNotification("è¯·è¾“å…¥å•†å“æ ‡é¢˜", "error");
            return;
          }
          if (isNaN(price) || price < 0) {
            showNotification("è¯·è¾“å…¥æœ‰æ•ˆçš„ä»·æ ¼", "error");
            return;
          }
          if (!contact) {
            showNotification("è¯·è¾“å…¥è”ç³»æ–¹å¼", "error");
            return;
          }

          const newProduct = {
            id: Date.now(),
            category,
            title,
            price,
            contact, // ä¿å­˜è”ç³»æ–¹å¼
            description,
            imageUrl,
            createdAt: new Date().toISOString()
          };

          products.unshift(newProduct); // æ·»åŠ åˆ°åˆ—è¡¨å¼€å¤´
          saveAndRender();

          // æ¸…ç©ºè¡¨å•
          form.reset();
          showNotification("å•†å“å‘å¸ƒæˆåŠŸï¼ä¹°å®¶å¯é€šè¿‡è”ç³»æ–¹å¼è”ç³»ä½ ");
        } catch (error) {
          showNotification("å‘å¸ƒå¤±è´¥ï¼Œè¯·é‡è¯•", "error");
          console.error("å‘å¸ƒå¤±è´¥:", error);
        } finally {
          // æ¢å¤æŒ‰é’®çŠ¶æ€
          buttonText.textContent = "å‘å¸ƒå•†å“";
          loadingIndicator.style.display = "none";
          submitBtn.disabled = false;
        }
      });

      // åˆ†ç±»ç­›é€‰
      categoryFilter.addEventListener("change", (e) => {
        currentFilter = e.target.value;
        renderProducts();
      });

      // æ¸…é™¤ç­›é€‰
      clearFilterBtn.addEventListener("click", () => {
        currentFilter = "all";
        categoryFilter.value = "all";
        renderProducts();
      });

      // åˆ é™¤å•†å“
      listContainer.addEventListener("click", (e) => {
        if (e.target.classList.contains("delete-btn")) {
          const productId = parseInt(e.target.dataset.id);
          if (confirm("ç¡®å®šè¦åˆ é™¤è¿™ä¸ªå•†å“å—ï¼Ÿ")) {
            products = products.filter(product => product.id !== productId);
            saveAndRender();
            showNotification("å•†å“å·²åˆ é™¤");
          }
        }
      });

      // ä¿å­˜å¹¶æ¸²æŸ“å•†å“åˆ—è¡¨
      function saveAndRender() {
        localStorage.setItem("secondHandProducts", JSON.stringify(products));
        renderProducts();
      }

      // æ¸²æŸ“å•†å“åˆ—è¡¨ï¼ˆåŒ…å«è”ç³»æ–¹å¼ï¼‰
      function renderProducts() {
        listContainer.innerHTML = "";

        // åº”ç”¨ç­›é€‰
        const filteredProducts = currentFilter === "all"
          ? products
          : products.filter(product => product.category === currentFilter);

        if (filteredProducts.length === 0) {
          listContainer.innerHTML = `
            <div class="empty-state">
              <i>ğŸ“¦</i>
              <h3>æš‚æ— å•†å“</h3>
              <p>${currentFilter === "all" ? "è¿˜æ²¡æœ‰å•†å“å‘å¸ƒï¼Œå¿«æ¥å‘å¸ƒç¬¬ä¸€ä¸ªå•†å“å§ï¼" : "è¯¥åˆ†ç±»ä¸‹æš‚æ— å•†å“"}</p >
            </div>
          `;
          return;
        }

        filteredProducts.forEach(product => {
          const card = document.createElement("div");
          card.className = "product-card";
          card.innerHTML = `
            <div class="product-img-container">
              < img class="product-img" src="${product.imageUrl}" alt="${product.title}">
            </div>
            <div class="product-info">
              <span class="product-category">${product.category}</span>
              <h3 class="product-title">${product.title}</h3>
              <div class="product-price">ï¿¥${product.price.toFixed(2)}</div>
              <div class="product-contact">ğŸ“ ${product.contact}</div> <!-- æ˜¾ç¤ºè”ç³»æ–¹å¼ -->
              <div class="product-desc">${product.description || "æ— æè¿°"}</div>
              <button class="delete-btn" data-id="${product.id}">åˆ é™¤å•†å“</button>
            </div>
          `;
          listContainer.appendChild(card);
        });
      }

      // æ˜¾ç¤ºé€šçŸ¥
      function showNotification(message, type = "success") {
        notification.textContent = message;
        notification.className = "notification";
        if (type === "error") {
          notification.classList.add("error");
        }
        notification.classList.add("show");

        setTimeout(() => {
          notification.classList.remove("show");
        }, 3000);
      }
    });
  </script>
</body>

</html>
